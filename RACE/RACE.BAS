DEFINT A-Z
SCREEN 13
DIM car%(600)
DIM bak%(600)

LINE (41, 1)-(80, 15), 255, BF
FOR y = 1 TO 15
FOR x = 1 TO 40
READ c
IF c > 0 THEN
  b = (x + y) MOD 2
  IF c < 7 THEN c = c + b * 8
  IF c = 7 THEN c = 15
  IF c = 8 THEN c = c - b
  PSET (x, y), c
  PSET (x + 40, y), 0
END IF
NEXT x
NEXT y
GET (1, 1)-(40, 15), car%
GET (41, 1)-(80, 15), bak%
CONST gray = 65793
CONST yellow = 257
CONST blue = 65536
FOR a = 1 TO 255
LINE (a, 0)-(a, 50), a
NEXT a

FOR a = 0 TO 15
d = a * 4
c = (15 - a) * 4
PALETTE a + 17, (32 + c \ 2) * gray
NEXT a
FOR a = 0 TO 15
d = a * 4
c = (15 - a) * 4
PALETTE a + 32, (32 + d \ 2) * gray
NEXT a
DIM tr(1000)
PSET (160, 200)
ct = STICK(0)
tx = STICK(0)
ty = STICK(1)
FOR a = 1 TO 1000
g = STICK(0) - ct
an = an - g / 40
tr(a) = an
z = tr(a)
c = a MOD 32 + 17
DRAW "c=" + VARPTR$(c) + "ta=" + VARPTR$(z) + "u14d13"
NEXT a
pp = 0
x = 160
an = tr(1)
DO
a$ = INKEY$
sx = -STICK(0) + tx
sy = -STICK(1) + ty
PSET (sx + 160, sy + 20)
IF pp > 940 THEN sp = sp - 1
'IF sp > 50 THEN sp = 50
sp = sp + sy / 20
an = an + sx / 10
dd = dd + sp
pp = pp + dd \ 10
IF pp < 1 THEN pp = 1
IF pp > 970 THEN pp = 0: an = tr(pp)
dd = dd MOD 10
c = 0
k = 200
x = x + (tr(pp + 2) - an) * sp / 50
IF x < 30 OR x > 290 THEN sp = sp / 2: IF x < 30 THEN x = 30 ELSE x = 290
SOUND 37 + ABS(sp) * 5, .1
SOUND 50 + ABS(sp) * 3, .1
FOR a = 0 TO 20
c = c + (tr(pp + a) - an) / 4
g = 200 / 2 ^ (a / 4)
f = (a + pp) MOD 31 + 17
IF a + pp > 950 THEN f = 14 + (a + pp) MOD 2
t = 200 - a * 5
b = t + 5
m = 160 - c
LINE (m - g, t)-(0, b), 2, BF
LINE (m - g, t)-(m + g, b), f, BF
LINE (320, t)-(m + g, b), 2, BF
IF a = 4 THEN PUT (x - 20, 180), bak%, AND: PUT (x - 20, 180), car%: SOUND 37 + ABS(sp) * 5, .1: SOUND 50 + ABS(sp) * 3, .1

NEXT a
SOUND 37 + ABS(sp) * 5, .1
SOUND 50 + ABS(sp) * 3, .1
LINE (0, 0)-(320, 100), 1, BF
FOR a = (an * 5) MOD 100 TO 320 STEP 100
LINE (a, 40)-(a + 30, 100), 6, BF
NEXT a

LOOP WHILE pp < 990

DATA 0,0,0,0,0,7,7,7,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,7,7,7,0,0,0,0,0
DATA 0,0,0,0,0,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,7,8,8,4,8,8,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,8,8,4,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,7,8,8,8,8,4,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,7,8,8,8,8,4,0,0,0,0,0,0
DATA 0,0,7,7,7,0,7,8,8,8,8,8,4,6,6,6,8,8,8,8,8,8,8,8,8,8,8,7,8,8,8,8,8,4,0,7,7,7,0,0
DATA 0,7,8,8,8,8,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,8,8,8,8,0
DATA 0,7,8,8,8,8,4,6,4,7,7,6,4,4,4,6,4,4,4,6,4,4,4,6,4,4,4,6,4,7,7,6,4,4,7,8,8,8,8,0
DATA 0,8,8,8,8,8,4,4,7,4,4,8,6,4,6,4,6,4,6,4,6,4,6,4,6,4,6,4,7,4,4,8,4,4,8,8,8,8,8,0
DATA 0,8,8,8,8,8,4,4,7,4,4,8,4,6,4,4,4,7,7,7,7,6,4,4,4,6,4,4,7,4,4,8,4,4,8,8,8,8,8,0
DATA 0,8,8,8,8,8,4,4,6,8,8,4,6,4,6,4,6,7,8,8,8,4,6,4,6,4,6,4,6,8,8,4,4,4,8,8,8,8,8,0
DATA 0,8,8,8,8,8,4,6,4,4,4,6,4,4,4,6,4,4,4,6,4,4,4,6,4,4,4,6,4,4,4,6,4,4,8,8,8,8,8,0
DATA 0,8,8,8,8,8,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,8,8,8,8,8,0
DATA 0,0,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,0,0

