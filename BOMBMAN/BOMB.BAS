CHDIR "\tim\bombman"

SCREEN 13
CLS :
'PALETTE 0, 65536 * 40
LINE (12, 3)-(312, 190), 15, B
LINE (14, 5)-(310, 188), 15, B
LOCATE 4, 8: PRINT "    << Dynamite Men >>   "
LOCATE 10, 7: PRINT "You must turn on the Num Lock"
LOCATE 14, 7: PRINT "and Caps Lock when you are "
LOCATE 18, 7: PRINT "playing this game.         "
LOCATE 23, 25: PRINT "    by Hung"
BEEP: A$ = INPUT$(1)
CLS

FOR X = 101 TO 105

NEXT X
DIM POST(1 TO 4000), LO(1 TO 100), DEMO1(1 TO 140), DEMO2(1 TO 140)
DIM DEMO3(1 TO 140), DEMO4(1 TO 140), DEMO5(1 TO 140), B1(1 TO 140), B2(1 TO 140), B3(1 TO 140)
DIM L1(1 TO 120), L2(1 TO 120), L3(1 TO 120)
IF STICK(0) <> 0 AND STICK(1) <> 0 THEN GOSUB USEJO
DEF SEG = VARSEG(DEMO1(1)): BLOAD "DEMO1.GRH", VARPTR(DEMO1(1))
DEF SEG = VARSEG(DEMO2(1)): BLOAD "DEMO2.GRH", VARPTR(DEMO2(1))
DEF SEG = VARSEG(DEMO3(1)): BLOAD "DEMO3.GRH", VARPTR(DEMO3(1))
DEF SEG = VARSEG(DEMO4(1)): BLOAD "DEMO4.GRH", VARPTR(DEMO4(1))
DEF SEG = VARSEG(DEMO5(1)): BLOAD "DEMO5.GRH", VARPTR(DEMO5(1))
DEF SEG = VARSEG(B1(1)): BLOAD "BO1.GRH", VARPTR(B1(1))
DEF SEG = VARSEG(B2(1)): BLOAD "BO2.GRH", VARPTR(B2(1))
DEF SEG = VARSEG(B3(1)): BLOAD "BO3.GRH", VARPTR(B3(1))
DEF SEG = VARSEG(L1(1)): BLOAD "R1.GRH", VARPTR(L1(1))
DEF SEG = VARSEG(L2(1)): BLOAD "R2.GRH", VARPTR(L2(1))
DEF SEG = VARSEG(L3(1)): BLOAD "R3.GRH", VARPTR(L3(1))
DEF SEG = VARSEG(POST(1)): BLOAD "BOMBER.GRH", VARPTR(POST(1))
DEF SEG
LINE (0, 0)-(320, 197), 21, BF
LINE (48, 92)-(200, 120), 18, BF
LINE (201, 97)-(271, 120), 18, BF
'PUT (50, 50), POST, PSET
LINE (0, 94)-(49, 92), 6
LINE (269, 97)-(320, 99), 6
LINE (0, 95)-(49, 93), 18
LINE (269, 98)-(320, 100), 18
PAINT (150, 160), 18, 18
LINE (15, 124)-(295, 165), 6, BF
LINE (20, 119)-(300, 160), 16, B
LINE (21, 120)-(299, 159), 17, B
LINE (22, 121)-(298, 158), 15, B
LINE (23, 122)-(297, 157), 17, B
LINE (24, 123)-(296, 156), 13, BF
GOSUB CARTOON
YY:
LOCATE 17, 13: PRINT "Human VS Computer"
LOCATE 19, 13: PRINT " Human VS Human"
LOCATE 17 + Y * 2, 11: PRINT " "
A$ = INKEY$
IF A$ = CHR$(0) + "P" OR A$ = CHR$(0) + "H" OR ST > 0 AND STICK(1) < 50 OR ST > 0 AND STICK(1) > 200 THEN Y = 1 - Y: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(13) OR ST > 0 AND STRIG(0) < 0 THEN PlayMODE = Y + 1: SOUND 2500, .1: SOUND 10000, .1: GOSUB CARTOON2: GOTO YY2
LOCATE 17 + Y * 2, 11: PRINT CHR$(26)
GOSUB WW
GOTO YY
YY2:
IF PlayMODE = 1 THEN GOTO YYY3
Y = 1
YY3:
RX(1) = 17: RY(1) = 8
RX(2) = 17: RY(2) = 21
RX(3) = 19: RY(3) = 8
RX(4) = 19: RY(4) = 21
LOCATE 17, 10: PRINT "2 Players    3 Players "
LOCATE 19, 10: PRINT "4 Players       Exit   "
LOCATE RX(Y), RY(Y): PRINT " "
A$ = INKEY$
IF A$ = CHR$(0) + "M" OR ST > 0 AND STICK(0) < 50 THEN Y = Y + 1: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "K" OR ST > 0 AND STICK(0) > 200 THEN Y = Y - 1: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "P" OR ST > 0 AND STICK(1) > 200 THEN Y = Y + 2: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "H" OR ST > 0 AND STICK(1) < 50 THEN Y = Y - 2: SOUND 2000, .1: SOUND 10000, .1
IF Y < 1 THEN Y = Y + 4
IF Y > 4 THEN Y = Y - 4
IF ST > 0 AND STRIG(0) < 0 THEN A$ = CHR$(13)
IF A$ = CHR$(13) THEN IF Y = 4 THEN Y = 0: SOUND 2500, .1: SOUND 10000, .1: GOSUB CARTOON2: LINE (24, 123)-(296, 156), 13, BF: GOTO YY
IF A$ = CHR$(13) THEN Players = Y: SOUND 2500, .1: SOUND 10000, .1: GOSUB CARTOON2: GOTO CHAINING
LOCATE RX(Y), RY(Y): PRINT CHR$(26)
GOSUB WW
GOTO YY3
CHAINING:
CLS
PSET (0, 0), PlayMODE
PSET (0, 1), Players + 1
PSET (0, 4), ST
CHAIN "MAIN.RUN"
YYY3:
Y = 1
YY32:
RX(1) = 17: RY(1) = 8
RX(2) = 17: RY(2) = 21
RX(3) = 19: RY(3) = 8
RX(4) = 19: RY(4) = 21
LOCATE 17, 10: PRINT "1 Player     2 Players "
LOCATE 19, 10: PRINT "3 Players       Exit   "
LOCATE RX(Y), RY(Y): PRINT " "
A$ = INKEY$
IF A$ = CHR$(0) + "M" OR ST > 0 AND STICK(0) < 50 THEN Y = Y + 1: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "K" OR ST > 0 AND STICK(0) > 200 THEN Y = Y - 1: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "P" OR ST > 0 AND STICK(1) > 200 THEN Y = Y + 2: SOUND 2000, .1: SOUND 10000, .1
IF A$ = CHR$(0) + "H" OR ST > 0 AND STICK(1) < 50 THEN Y = Y - 2: SOUND 2000, .1: SOUND 10000, .1
IF Y < 1 THEN Y = Y + 4
IF Y > 4 THEN Y = Y - 4
IF ST > 0 AND STRIG(0) < 0 THEN A$ = CHR$(13)
IF A$ = CHR$(13) THEN IF Y = 4 THEN Y = 0: SOUND 2500, .1: SOUND 10000, .1: GOSUB CARTOON2: LINE (24, 123)-(296, 156), 13, BF: GOTO YY
IF A$ = CHR$(13) THEN Players = Y - 1: SOUND 2500, .1: SOUND 10000, .1:  GOSUB CARTOON2: GOTO CHAINING
LOCATE RX(Y), RY(Y): PRINT CHR$(26)
GOSUB WW
GOTO YY32
STICKK:
LINE (110, 55)-(200, 145), 21, BF
LINE (140, 55)-(170, 145), 11, B
LINE (110, 85)-(200, 115), 11, B
LINE (110, 55)-(200, 145), 11, B
TESTING:
XT = 160: YT = 100: CO = 19
IF STICK(0) < 70 THEN XT = 130
IF STICK(0) > 130 THEN XT = 190
IF STICK(1) < 70 THEN YT = 70
IF STICK(1) > 130 THEN YT = 130
IF STRIG(0) < 0 THEN CO = 8
IF STRIG(4) < 0 THEN CO = 6
LINE (XT - 19, YT - 14)-(XT + 9, YT + 14), CO, BF
GOSUB WW
LOCATE 5, 9: PRINT "    Joystick Testing   "
LOCATE 20, 13: PRINT "Hit Esc to Exit.         "
LINE (XT - 19, YT - 14)-(XT + 9, YT + 14), 21, BF
A$ = INKEY$
IF A$ = CHR$(27) THEN RETURN
GOTO TESTING
USEJO:
LOCATE 12, 4: PRINT " Do you want to use the joystick?"
A$ = INPUT$(1)
IF A$ = "Y" OR A$ = "y" THEN CLS : GOTO U2
IF A$ = "N" OR A$ = "n" THEN RETURN
GOTO USEJO
U2:
LOCATE 12, 8: PRINT "For which Player? (1-4)"
A$ = INPUT$(1)
IF VAL(A$) > 0 AND VAL(A$) < 5 THEN ST = VAL(A$): CLS : GOTO U3
GOTO U2
U3:
GOSUB STICKK
RETURN
WW:
TYT = TIMER
YYY:
IF TIMER - TYT < .05 THEN GOTO YYY
RETURN
CARTOON:
FOR X = 1 TO 40 STEP 3
GOSUB WW
LINE (X - 20, 100)-(23 + X, 118), 18, BF
T = T + 1: IF T > 3 THEN T = 0
IF T = 0 THEN PUT (X, 99), L2, PSET
IF T = 1 OR T = 3 THEN PUT (X, 99), L1, PSET
IF T = 2 THEN PUT (X, 99), L3, PSET
NEXT X
CARTOON2:
LINE (32, 93)-(60, 118), 18, BF: PUT (40, 97), DEMO1, PSET: GOSUB WW
LINE (32, 93)-(60, 118), 18, BF: PUT (40, 93), DEMO2, PSET: GOSUB WW: GOSUB WW: GOSUB WW
LINE (32, 93)-(60, 118), 18, BF: PUT (40, 97), DEMO1, PSET
RETURN

