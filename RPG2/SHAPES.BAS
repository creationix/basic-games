DEFINT A-Z
DECLARE SUB anim (hp%)
DECLARE SUB loadpal (filename$)
DECLARE SUB savePal (filename$)
SCREEN 13
DIM c(21, 21)
loadpal "game.pal"
DIM p(400, 20)
FOR n = 0 TO 20
    sx = (n MOD 16) * 20
    sy = (n \ 16) * 20
    WINDOW SCREEN (0 - sx, 0 - sy)-(319 - sx, 199 - sy)
    'floor                            you walk on it Stupid!
    IF n = 0 THEN
    FOR y = 1 TO 20
        FOR x = 1 TO 20
            PSET (x, y), 4 * RND + 66 - CINT(RND * .56) * 10
        NEXT x
    NEXT y
    END IF
    IF n = 1 OR n = 7 THEN
    FOR y = 1 TO 20
        FOR x = 1 TO 20
            PSET (x, y), INT(3 * RND) + 1
        NEXT x
    NEXT y
    END IF
    IF n = 2 THEN
    FOR y = 1 TO 20
        FOR x = 1 TO 20
            PSET (x, y), 40 + 5 * RND + 32 + ((y MOD 4) < 2) * 4 + ((x MOD 8) < 2) * 32
        NEXT x
    NEXT y
    END IF
    IF n = 3 OR n > 18 THEN
    FOR y = 1 TO 20
        FOR x = 1 TO 20
            PSET (x, y), 4 * RND + 74
        NEXT x
    NEXT y
        LINE (1, 1)-(21, 21), 79, B
        LINE (0, 0)-(20, 20), 68, B
    END IF
    IF n = 4 OR n = 5 THEN
    FOR y = 1 TO 20
        FOR x = 1 TO 20
            PSET (x, y), 13 * RND + 32 + 16
        NEXT x
    NEXT y
    END IF
    IF n = 5 THEN
        FOR a = 11 TO 1 STEP -1
            CIRCLE (10, 10), a, 64 - a * 1.4, , , .5
            CIRCLE (11, 10), a, 64 - a * 1.4, , , 2
        NEXT a
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                c = POINT(x, y)
                IF c < 61 AND c > 48 THEN PSET (x, y), c + 3 * RND
            NEXT x
        NEXT y
    END IF
    IF n = 6 THEN
        FOR y = 1 TO 20
        FOR x = 1 TO 20
        PSET (x, y), ABS(SIN((x + y) / 3) + SIN((x - y) / 3)) * 4 + 8 * RND + 64
        NEXT x
        NEXT y
    END IF
    IF n = 7 THEN
        FOR a = 10 TO 0 STEP -1:
            CIRCLE (10, 10), a, 79 - a * 1, , , 1
            CIRCLE (11, 10), a, 79 - a * 1, , , 1
        NEXT a
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                c = POINT(x, y)
                IF c < 77 AND c > 64 THEN PSET (x, y), c + 3 * RND
            NEXT x
        NEXT y
    END IF
    IF n = 8 OR n = 9 OR (n >= 10 AND n < 19) OR n = 10 THEN
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                PSET (x, y), 64 + 5 * RND + (x MOD 4) + (y MOD 4)
            NEXT x
        NEXT y
    END IF
    IF n = 9 THEN
        FOR a = 9 TO 0 STEP -1:
            LINE (10 - a, 10 - a)-(a + 10, a + 10), 79 - a, B
        NEXT a
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                c = POINT(x, y)
                IF c < 77 AND c > 64 THEN PSET (x, y), c + 3 * RND
            NEXT x
        NEXT y
    END IF
    IF n = 11 THEN 'lava
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                PSET (x, y), INT(16 * RND + 80)
            NEXT x
        NEXT y
    END IF
    IF (n >= 12 AND n <= 20) OR n = 10 THEN
        FOR y = 1 TO 20
        FOR x = 1 TO 20
        READ c(x, y)
        NEXT x
        NEXT y
        FOR y = 1 TO 20
            FOR x = 1 TO 20
                IF c(x, y) > 0 THEN
                    o = c(x, y)
                    IF c(x, y - 1) < c(x, y) OR c(x - 1, y) < c(x, y) THEN c = 3
                    'IF c(x, y - 1) > c(x, y) AND c(x - 1, y) > c(x, y) THEN c = 0
                    IF c(x, y - 1) > c(x, y) OR c(x - 1, y) > c(x, y) THEN c = 1
                    IF c(x, y - 1) > c(x, y) AND c(x - 1, y) < c(x, y) THEN c = 2
                    IF c(x, y - 1) < c(x, y) AND c(x - 1, y) > c(x, y) THEN c = 2
                    IF c(x, y - 1) = c(x, y) AND c(x - 1, y) = c(x, y) THEN c = 2
                    IF c(x, y + 1) > c(x, y) AND c(x + 1, y) > c(x, y) THEN c = 4
                    IF c(x, y - 1) < c(x, y) AND c(x - 1, y) < c(x, y) THEN c = 4
                    d = c * 4 + 95 - 2 * RND
                    IF n = 14 THEN d = d - 32'clock
                    IF n = 15 THEN IF o = 3 THEN d = d - 16 'chest
                    IF n = 16 OR n = 17 THEN IF o = 1 THEN d = d - 64 - CINT(RND) * 16 + 4'bed head
                    IF n = 19 THEN d = d - 32: IF o = 5 THEN d = 95 - 16 * RND ELSE IF o = 4 THEN d = d + 32'fireplace
                    IF n = 20 THEN d = d - 32'window
                    PSET (x, y), d
                END IF
            NEXT x
        NEXT y
    END IF
    GET (1, 1)-(20, 20), p(0, n)
NEXT n
DEF SEG = VARSEG(p(0, 0))
BSAVE "RPG2.pic", 0, VARPTR(p(400, 20))
DO: LOOP WHILE INKEY$ = ""

DATA 0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,1,2,2,2,2,2,2,1,0,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,3,2,2,3,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,1,2,2,1,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0
DATA 0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0
DATA 0,0,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,0,0
DATA 0,0,1,2,2,2,2,2,1,2,2,1,2,2,2,2,2,1,0,0
DATA 0,0,1,2,1,1,1,1,1,2,2,1,1,1,1,1,2,1,0,0
DATA 0,0,1,2,1,0,0,0,1,2,2,1,0,0,1,1,2,1,0,0
DATA 0,0,1,2,2,1,0,0,1,2,2,1,0,0,1,2,2,1,0,0
DATA 0,0,1,1,2,1,0,0,1,2,2,1,0,0,1,2,1,1,0,0
DATA 0,0,0,1,1,1,0,1,2,2,2,2,1,0,1,1,1,0,0,0
DATA 0,0,0,0,0,0,1,2,2,1,1,2,2,1,0,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,2,0,0,2,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,1,0,0,1,2,2,1,0,0,0,0,0

DATA 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
DATA 1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
DATA 1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,1
DATA 1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,1,1,1,1,1,1,1,1,1,1,2,2,3,2,1
DATA 1,2,3,2,2,1,1,1,1,1,1,1,1,1,1,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,1,1,1,1,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,1,1,1,1,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,1,1,1,1,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,1,1,1,1,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,1,1,1,1,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,1
DATA 1,2,3,2,2,1,1,1,1,1,1,1,1,1,2,2,2,3,2,1
DATA 1,2,3,2,2,1,1,1,1,1,1,1,1,1,2,2,2,3,2,1
DATA 1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,1
DATA 1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,1
DATA 1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1
DATA 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0
DATA 0,0,0,0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0,0
DATA 0,0,0,0,1,2,3,3,3,3,3,3,3,3,2,1,0,0,0,0
DATA 0,0,0,1,2,3,2,2,2,2,2,2,2,2,3,2,1,0,0,0
DATA 0,0,1,2,3,1,1,1,1,1,1,1,1,1,1,3,2,1,0,0
DATA 0,1,2,3,2,1,2,3,2,3,2,3,2,3,1,2,3,2,1,0
DATA 0,1,2,3,2,1,3,4,4,4,4,4,4,2,1,2,3,2,1,0
DATA 0,1,2,3,2,1,2,4,3,3,3,3,4,3,1,2,3,2,1,0
DATA 0,1,2,3,2,1,2,4,3,3,3,3,4,3,1,2,3,2,1,0
DATA 0,1,2,3,2,1,3,4,4,4,4,4,4,2,1,2,3,2,1,0
DATA 0,1,2,3,2,1,2,3,2,3,2,3,2,3,1,2,3,2,1,0
DATA 0,0,1,2,3,1,1,1,1,1,1,1,1,1,1,3,2,1,0,0
DATA 0,0,0,1,2,3,2,2,2,2,2,2,2,2,3,2,1,0,0,0
DATA 0,0,0,0,1,2,3,3,3,3,3,3,3,3,2,1,0,0,0,0
DATA 0,0,0,0,0,1,2,2,2,2,2,2,2,2,1,0,0,0,0,0
DATA 0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0
DATA 0,0,0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0,0
DATA 0,0,0,1,2,1,1,1,2,2,1,2,1,1,1,2,1,0,0,0
DATA 0,0,0,1,2,1,2,1,2,2,1,1,1,1,1,2,1,0,0,0
DATA 0,0,0,1,2,1,1,1,2,3,2,1,1,2,1,2,1,0,0,0
DATA 0,0,0,1,2,2,1,1,3,4,3,1,1,1,1,2,1,0,0,0
DATA 0,0,0,1,2,1,1,1,2,3,2,1,2,1,1,2,1,0,0,0
DATA 0,0,0,1,2,1,2,1,1,2,2,1,1,1,1,2,1,0,0,0
DATA 0,0,0,0,1,2,1,1,1,2,2,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,4,4,4,4,4,4,4,4,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,1,3,3,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,1,3,3,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,1,3,3,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,1,3,3,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,3,4,4,3,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,3,4,4,3,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,1,1,1,1,1,1,1,1,2,1,0,0,0,0
DATA 0,0,0,0,1,2,2,2,2,2,2,2,2,2,2,1,0,0,0,0
DATA 0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0,0,0
DATA 0,0,0,0,0,3,1,1,1,1,1,1,1,1,3,0,0,0,0,0
DATA 0,0,0,0,3,1,1,1,1,1,1,1,1,1,1,3,0,0,0,0
DATA 0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0,0
DATA 0,0,0,3,1,1,1,1,2,2,2,2,1,1,1,1,3,0,0,0
DATA 0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0
DATA 0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0,0
DATA 0,0,0,3,1,2,1,2,1,2,1,2,1,2,1,1,3,0,0,0
DATA 0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0,0
DATA 0,0,0,3,1,1,2,1,2,1,2,1,2,1,2,1,3,0,0,0
DATA 0,0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0,0
DATA 0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2
DATA 2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2
DATA 2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2
DATA 2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2
DATA 0,0,1,2,3,3,3,3,3,3,3,3,3,3,3,3,2,1,0,0
DATA 0,0,1,2,3,3,3,3,3,3,3,3,3,3,3,3,2,1,0,0
DATA 0,0,1,2,3,3,3,3,3,3,3,3,3,3,3,3,2,1,0,0
DATA 0,0,1,2,3,3,3,3,3,3,3,3,3,3,3,3,2,1,0,0
DATA 0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0

DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0
DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0
DATA 2,2,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,2,2
DATA 2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2
DATA 2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2
DATA 2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,4,4,4,4,4,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,4,4,4,4,4,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,4,4,4,4,4,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,2,2,2,2,2,2,2,2,2,2,2,2,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0
DATA 0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0
DATA 0,0,0,0,1,1,4,4,4,4,4,4,4,4,1,1,0,0,0,0
DATA 0,0,0,1,1,3,3,3,3,3,3,3,3,3,3,1,1,0,0,0
DATA 0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,0
DATA 0,0,0,1,2,5,1,5,1,5,1,1,1,1,5,2,1,0,0,0
DATA 0,0,0,1,2,1,1,5,1,1,1,5,1,5,1,2,1,0,0,0
DATA 0,0,0,1,2,5,1,5,1,5,1,5,1,5,1,2,1,0,0,0
DATA 0,0,0,1,2,5,5,5,5,5,5,5,5,5,5,2,1,0,0,0
DATA 0,0,0,1,2,5,5,5,5,5,5,5,5,5,5,2,1,0,0,0
DATA 0,0,0,1,2,5,5,5,5,5,5,5,5,5,5,2,1,0,0,0
DATA 0,0,0,1,2,5,5,5,5,5,5,5,5,5,5,2,1,0,0,0
DATA 0,0,0,1,2,4,1,4,1,4,1,4,1,4,1,2,1,0,0,0
DATA 0,0,0,1,2,1,4,1,4,1,4,1,4,1,4,2,1,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,1,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,2,2,2,2,2,2,2,2,2,2,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,1,1,1,1,2,1,1,1,1,1,3,1,3,0,0
DATA 0,0,3,1,3,3,3,3,3,3,3,3,3,3,3,3,1,3,0,0
DATA 0,0,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,0,0
DATA 0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

SUB anim (hp%)
OUT &H3C8, 1
OUT &H3C9, 0: OUT &H3C9, 0: OUT &H3C9, ABS(hp - 32) + 31
OUT &H3C9, 0: OUT &H3C9, 0: OUT &H3C9, ABS(((hp + 20) MOD 64) - 32) + 31
OUT &H3C9, 0: OUT &H3C9, 0: OUT &H3C9, ABS(((hp + 40) MOD 64) - 32) + 31
OUT &H3C9, 0: OUT &H3C9, ABS((hp) MOD 64 * 2 - 63): OUT &H3C9, 0
OUT &H3C8, 80
FOR a = 0 TO 15         '80-95 Fire shades
OUT &H3C9, 32 + ((hp + a * 4) MOD 64 \ 2)
OUT &H3C9, ((hp + a * 4) MOD 64) * ((hp + a * 4) MOD 64) \ 64
OUT &H3C9, 0
NEXT a

END SUB

DEFSNG A-Z
SUB loadpal (filename$)
DIM pal(767)  AS STRING * 1
DEF SEG = VARSEG(pal(1))
BLOAD filename$, 0
DEF SEG
OUT &H3C8, 0
FOR a% = 3 TO 767
    OUT &H3C9, ASC(pal(a%))
NEXT a%
END SUB

SUB savePal (filename$)
DIM pal(767) AS STRING * 1
OUT &H3C8, 0
FOR a% = 0 TO 767
    pal(a%) = CHR$(INP(&H3C9))
NEXT a%
DEF SEG = VARSEG(pal(0))
BSAVE filename$, 0, 768
DEF SEG
END SUB

