'CLEAR , , 10000
JOY = 0
RANDOMIZE (TIMER)
SCREEN 7
DIM A1%(140), A2%(140), A3%(140), A4%(140), A5%(140), A6%(140), A7%(140), A8%(140), A9%(140), A10%(140), A11%(140)
DIM X(2000), Y(2000)
FOR N = 1 TO 11
FOR Y = 1 TO 10
FOR X = 1 TO 14
READ C
'IF C > 0 THEN IF C = 8 THEN C = 0 ELSE IF C = 15 THEN C = 3 ELSE IF C = 7 THEN C = 1 ELSE C = 2
PSET (X, Y), C
NEXT X
NEXT Y
IF N = 1 THEN GET (1, 1)-(14, 10), A1%
IF N = 2 THEN GET (1, 1)-(14, 10), A2%
IF N = 3 THEN GET (1, 1)-(14, 10), A3%
IF N = 4 THEN GET (1, 1)-(14, 10), A4%
IF N = 5 THEN GET (1, 1)-(14, 10), A5%
IF N = 6 THEN GET (1, 1)-(14, 10), A6%
IF N = 7 THEN GET (1, 1)-(14, 10), A7%
IF N = 8 THEN GET (1, 1)-(14, 10), A8%
IF N = 9 THEN GET (1, 1)-(14, 10), A9%
IF N = 10 THEN GET (1, 1)-(14, 10), A10%
IF N = 11 THEN GET (1, 1)-(14, 10), A11%
NEXT N
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,7,1,7,7,7,7,8,0,0
DATA 0,8,7,7,7,1,1,7,7,7,7,7,8,0
DATA 8,7,7,7,7,7,1,7,7,7,7,7,7,8
DATA 15,7,7,7,7,7,1,7,7,7,7,7,7,15
DATA 0,15,7,7,7,7,1,7,7,7,7,7,15,0
DATA 0,0,15,7,7,1,1,1,7,7,7,15,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,2,2,2,7,7,7,8,0,0
DATA 0,8,7,7,2,7,7,7,2,7,7,7,8,0
DATA 8,7,7,7,7,7,7,2,7,7,7,7,7,8
DATA 15,7,7,7,7,7,2,7,7,7,7,7,7,15
DATA 0,15,7,7,7,2,7,7,7,7,7,7,15,0
DATA 0,0,15,7,2,2,2,2,2,7,7,15,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0:
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,7,3,3,7,7,7,8,0,0
DATA 0,8,7,7,7,3,7,7,3,7,7,7,8,0
DATA 8,7,7,7,7,7,7,7,3,7,7,7,7,8
DATA 15,7,7,7,7,7,3,3,7,7,7,7,7,15
DATA 0,15,7,7,7,7,7,7,3,7,7,7,15,0
DATA 0,0,15,7,7,3,7,7,3,7,7,15,0,0
DATA 0,0,0,15,7,7,3,3,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,4,7,7,4,7,7,8,0,0
DATA 0,8,7,7,7,4,7,7,4,7,7,7,8,0
DATA 8,7,7,7,7,4,7,7,4,7,7,7,7,8
DATA 15,7,7,7,7,4,4,4,4,7,7,7,7,15
DATA 0,15,7,7,7,7,7,7,4,7,7,7,15,0
DATA 0,0,15,7,7,7,7,7,4,7,7,15,0,0
DATA 0,0,0,15,7,7,7,7,4,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,5,5,5,5,5,7,7,8,0,0
DATA 0,8,7,7,5,7,7,7,7,7,7,7,8,0
DATA 8,7,7,7,5,5,5,5,7,7,7,7,7,8
DATA 15,7,7,7,7,7,7,7,5,7,7,7,7,15
DATA 0,15,7,7,5,7,7,7,5,7,7,7,15,0
DATA 0,0,15,7,7,5,5,5,7,7,7,15,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,7,6,6,7,7,7,8,0,0
DATA 0,8,7,7,7,6,7,7,6,7,7,7,8,0
DATA 8,7,7,7,7,6,7,7,7,7,7,7,7,8
DATA 15,7,7,7,7,6,6,6,7,7,7,7,7,15
DATA 0,15,7,7,7,6,7,7,6,7,7,7,15,0
DATA 0,0,15,7,7,6,7,7,6,7,7,15,0,0
DATA 0,0,0,15,7,7,6,6,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,15,7,7,7,7,7,7,7,7,15,0,0
DATA 0,15,7,7,7,7,7,7,7,7,7,7,15,0
DATA 15,7,7,7,7,7,7,7,7,7,7,7,7,15
DATA 8,7,7,7,7,7,7,7,7,7,7,7,7,8
DATA 0,8,7,7,7,7,7,7,7,7,7,7,8,0
DATA 0,0,8,7,7,7,7,7,7,7,7,8,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,7,7,8,0,0,0
DATA 0,0,8,7,7,7,7,7,7,7,7,8,0,0
DATA 0,8,7,7,7,7,7,7,7,7,7,7,8,0
DATA 8,7,7,7,7,7,7,7,7,7,7,7,7,8
DATA 15,7,7,7,7,7,7,7,7,7,7,7,7,15
DATA 0,15,7,7,7,7,7,7,7,7,7,7,15,0
DATA 0,0,15,7,7,7,7,7,7,7,7,15,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
DATA 0,0,0,8,7,7,7,7,4,4,8,0,0,0
DATA 0,0,8,7,7,7,7,4,12,4,7,8,0,0
DATA 0,8,7,7,7,7,4,12,4,4,4,7,8,0
DATA 8,7,7,7,7,4,12,12,12,4,7,7,7,8
DATA 15,7,7,7,4,4,4,12,4,7,7,7,7,15
DATA 0,15,7,7,7,4,12,4,7,7,7,7,15,0
DATA 0,0,15,7,4,12,4,7,7,7,7,15,0,0
DATA 0,0,0,15,4,4,7,7,7,7,15,0,0,0
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
'
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,15,7,7,7,9,9,7,7,7,15,0,0
DATA 0,15,7,7,7,9,7,7,9,7,7,7,15,0
DATA 15,7,7,7,7,9,7,7,9,7,7,7,7,15
DATA 8,7,7,7,7,7,7,7,9,7,7,7,7,8
DATA 0,8,7,7,7,7,7,9,7,7,7,7,8,0
DATA 0,0,8,7,7,7,7,7,7,7,7,8,0,0
DATA 0,0,0,8,7,7,7,9,7,7,8,0,0,0
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
'
DATA 0,0,0,0,15,15,15,15,15,15,0,0,0,0
DATA 0,0,0,15,7,7,7,7,7,7,15,0,0,0
DATA 0,0,15,7,7,7,7,7,7,7,7,15,0,0
DATA 0,15,7,7,7,10,10,10,6,7,7,7,15,0
DATA 15,7,7,7,7,9,9,9,6,7,7,7,7,15
DATA 8,7,7,7,7,10,10,10,6,7,7,7,7,8
DATA 0,8,7,7,7,7,7,7,6,7,7,7,8,0
DATA 0,0,8,7,7,7,7,7,6,7,7,8,0,0
DATA 0,0,0,8,7,7,7,6,6,6,8,0,0,0
DATA 0,0,0,0,8,8,8,8,8,8,0,0,0,0
8
'CREEN 7
INPUT "X-"; MX
INPUT "Y-"; MY
IF MX > 31 OR MY > 19 THEN SCREEN 8
IF MY > 19 THEN SCREEN 9
IF MY > 34 THEN SCREEN 12
IF MX > 63 THEN MX = 63
IF MY > 47 THEN MY = 47
PRINT "X-"; MX; "Y-"; MY
REDIM L(MX + 1, MY + 1)
INPUT "Mines"; MN
INPUT "Bolts"; PN
5
FOR A = 1 TO MN
RD:
X = INT(MX * RND + 1)
Y = INT(MY * RND + 1)
IF L(X, Y) = 0 THEN L(X, Y) = 1 ELSE GOTO RD
NEXT A
FOR A = 1 TO PN
LD:
X = INT(MX * RND + 1)
Y = INT(MY * RND + 1)
IF L(X, Y) = 0 THEN L(X, Y) = 2 ELSE GOTO LD
NEXT A
GOSUB 2
X = INT(MX / 2 + .5)
Y = INT(MY / 2 + .5)
BN = MX * MY - MN
BB = 0
1 A$ = INKEY$
OX = X: OY = Y
IF JOY = 1 THEN
JX = STICK(0)
JY = STICK(1)
B1 = STRIG(0)
B2 = STRIG(4)
IF JX < 70 THEN X = X - 1
IF JX > 130 THEN X = X + 1
IF JY < 70 THEN Y = Y - 1
IF JY > 130 THEN Y = Y + 1
IF B1 = -1 THEN A$ = " "
IF B2 = -1 THEN A$ = "F"
END IF

IF BN = 0 THEN FOR A = 1 TO 100: COLOR 15 * RND, 15 * RND: NEXT A: REDIM L(MX + 1, MY + 1): DEAD = 0: COLOR , 0: GOTO 5
IF A$ = "`" THEN RUN "MINESWEP"
IF A$ = "R" THEN GOTO 8
IF A$ = "Q" THEN DEAD = 1
IF A$ = "8" THEN Y = Y - 1:                     
IF A$ = "4" THEN X = X - 1:
IF A$ = "2" THEN Y = Y + 1:
IF A$ = "6" THEN X = X + 1:
IF Y < 1 THEN Y = 1
IF X < 1 THEN X = 1
IF Y > MY THEN Y = MY
IF X > MX THEN X = MX
IF DEAD = 1 THEN FOR A = 1 TO 10: CIRCLE (X * 10 - 3, Y * 10 - 3), A, 12: CIRCLE (X * 10 - 4, Y * 10 - 4), A, 4: NEXT A: REDIM L(MX + 1, MY + 1): DEAD = 0: GOTO 5
IF A$ = " " THEN
L = L(X, Y)
IF L = 1 THEN DEAD = 1
IF L = 7 THEN DEAD = 1
IF L(X, Y) = 6 THEN L(X, Y) = 9: BN = BN - 1
IF L = 0 OR L = 9 OR L = 2 OR L = 8 THEN
IF L = 8 OR L = 2 THEN L(X, Y) = 10: GOSUB LZ1
IF L = 0 THEN L(X, Y) = 9: BN = BN - 1
XX = X: YY = Y
GOSUB 3
IF B = 0 THEN LN = 0: X(0) = X: Y(0) = Y: GOSUB 6
X = XX
Y = YY
END IF
END IF
'**************
IF A$ = "F" THEN
L = L(X, Y)
IF L = 0 THEN L = 3: GOTO 7
IF L = 1 THEN L = 4: GOTO 7
IF L = 2 THEN L = 5: GOTO 7
IF L = 3 THEN L = 6: GOTO 7
IF L = 4 THEN L = 7: GOTO 7
IF L = 5 THEN L = 8: GOTO 7
IF L = 6 THEN L = 0: GOTO 7
IF L = 7 THEN L = 1: GOTO 7
IF L = 8 THEN L = 2: GOTO 7
7
L(X, Y) = L
END IF
XX = X: YY = Y: X = OX: Y = OY: GOSUB 3
X = XX: Y = YY
GOTO 1
6
X = X(LN) + 1: Y = Y(LN): GOSUB 9
X = X(LN): Y = Y(LN) - 1: GOSUB 9
X = X(LN) - 1: Y = Y(LN): GOSUB 9
X = X(LN): Y = Y(LN) + 1: GOSUB 9
IF X(LN) / 2 = INT(X(LN) / 2) THEN TY = 2 ELSE TY = 1
X = X(LN) - 1
IF X / 2 = INT(X / 2) THEN TY = 2 ELSE TY = 1
IF TY = 2 THEN Y = Y(LN) - 1 ELSE Y = Y(LN) + 1
GOSUB 9
X = X(LN) + 1
IF X / 2 = INT(X / 2) THEN TY = 2 ELSE TY = 1
IF TY = 2 THEN Y = Y(LN) - 1 ELSE Y = Y(LN) + 1
GOSUB 9
LN = LN - 1
RETURN
9 IF X <= 0 OR Y <= 0 OR X > MX OR Y > MY THEN RETURN
IF L(X, Y) = 8 OR L(X, Y) = 2 THEN
L(X, Y) = 10: GOSUB 3: GOSUB LZ1
IF B = 0 THEN LN = LN + 1: X(LN) = X: Y(LN) = Y: GOSUB 6
END IF
IF L(X, Y) = 0 THEN
L(X, Y) = 9
BN = BN - 1
GOSUB 3
IF B = 0 THEN LN = LN + 1: X(LN) = X: Y(LN) = Y: GOSUB 6
END IF
RETURN
2
CLS : FOR Y = 1 TO MY: FOR X = 1 TO MX: GOSUB 3: NEXT X: NEXT Y: RETURN
3
IF INT(X / 2) = X / 2 THEN PY = Y * 10 - 5 ELSE PY = Y * 10 - 10
PX = X * 10 - 6
IF L(X, Y) = 9 THEN GOTO 12
FOR A = 0 TO 4
LINE (PX + 4 - A, PY + A)-(PX + 9 + A, PY + 9 - A), 0, BF
NEXT A
12
IF L(X, Y) = 0 THEN PUT (PX, PY), A7%, XOR
IF L(X, Y) = 1 THEN PUT (PX, PY), A7%, XOR
IF L(X, Y) = 2 THEN PUT (PX, PY), A7%, XOR
IF L(X, Y) = 3 THEN PUT (PX, PY), A11%, XOR
IF L(X, Y) = 4 THEN PUT (PX, PY), A11%, XOR
IF L(X, Y) = 5 THEN PUT (PX, PY), A11%, XOR
IF L(X, Y) = 6 THEN PUT (PX, PY), A10%, XOR
IF L(X, Y) = 7 THEN PUT (PX, PY), A10%, XOR
IF L(X, Y) = 8 THEN PUT (PX, PY), A10%, XOR
IF L(X, Y) = 10 THEN PUT (PX, PY), A9%, XOR
B = 0
IF L(X, Y) = 9 THEN
FOR AY = Y - 1 TO Y + 1: FOR AX = X - 1 TO X + 1
IF INT(AX / 2) = AX / 2 THEN TY = 2 ELSE TY = 1
IF AY = Y + 1 AND AX <> X AND TY = 2 THEN 11
IF AY = Y - 1 AND AX <> X AND TY = 1 THEN 11
LL = 0: IF AX > 0 AND AY > 0 AND AY < MY + 1 AND AX < MX + 1 THEN LL = L(AX, AY)
IF LL = 1 OR LL = 7 OR LL = 4 THEN B = B + 1
11
NEXT AX: NEXT AY
FOR A = 0 TO 4
LINE (PX + 4 - A, PY + A)-(PX + 9 + A, PY + 9 - A), 0, BF
NEXT A
IF Y > 0 AND X > 0 AND Y < MY + 1 AND X < MX + 1 AND B = 0 THEN
 PUT (PX, PY), A8%, XOR
 ELSE
  IF B >= 1 THEN ON B GOSUB P1, P2, P3, P4, P5, P6
END IF
END IF
RETURN
P1:
 PUT (PX, PY), A1%: RETURN
P2:
 PUT (PX, PY), A2%: RETURN
P3:
 PUT (PX, PY), A3%: RETURN
P4:
 PUT (PX, PY), A4%: RETURN
P5:
 PUT (PX, PY), A5%: RETURN
P6:
 PUT (PX, PY), A6%: RETURN
LZ1:
 TXX = X: TYY = Y: SX = X: SY = Y
FOR X = SX - 1 TO SX + 1: FOR Y = SY - 1 TO SY + 1
IF X / 2 = INT(X / 2) THEN TT = 2 ELSE TT = 1
IF Y = SY - 1 AND X <> SX AND TT = 1 THEN 13
IF Y = SY + 1 AND X <> SX AND TT = 2 THEN 13
IF L(X, Y) = 1 OR L(X, Y) = 7 THEN L(X, Y) = 4: GOSUB 3
13 NEXT Y: NEXT X: X = TXX: Y = TYY
FOR ZA = 1 TO 9.4 STEP .3: SOUND 400 + SIN(ZA) * 200, .07: NEXT ZA
L(X, Y) = 9: GOSUB 3: BN = BN - 1
RETURN

