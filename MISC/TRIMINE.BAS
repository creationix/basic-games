CLEAR , , 10000
RANDOMIZE (TIMER)
JOY = 1
SCREEN 7
DIM A11%(192), A21%(192), A31%(192), A41%(192), A51%(192), A61%(192), A71%(192)
DIM A12%(192), A22%(192), A32%(192), A42%(192), A52%(192), A62%(192), A72%(192)
DIM X(2000), Y(2000)
FOR N = 1 TO 7
FOR Y = 1 TO 32
FOR X = 1 TO 12
READ C
IF C = 8 THEN C = 15 ELSE IF C = 15 THEN C = 8
PSET (X, Y), C
NEXT X
NEXT Y
IF N = 1 THEN GET (1, 1)-(12, 16), A11%: GET (1, 17)-(12, 32), A12%
IF N = 2 THEN GET (1, 1)-(12, 16), A21%: GET (1, 17)-(12, 32), A22%
IF N = 3 THEN GET (1, 1)-(12, 16), A31%: GET (1, 17)-(12, 32), A32%
IF N = 4 THEN GET (1, 1)-(12, 16), A41%: GET (1, 17)-(12, 32), A42%
IF N = 5 THEN GET (1, 1)-(12, 16), A51%: GET (1, 17)-(12, 32), A52%
IF N = 6 THEN GET (1, 1)-(12, 16), A61%: GET (1, 17)-(12, 32), A62%
IF N = 7 THEN GET (1, 1)-(12, 16), A71%: GET (1, 17)-(12, 32), A72%
NEXT N
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,7,7,7,7,8,8,0,0,0
DATA 15,7,7,7,7,7,7,7,7,8,0,0
DATA 15,7,7,7,7,7,7,7,7,7,8,0
DATA 15,7,7,7,7,7,7,7,7,7,8,0
DATA 15,7,7,7,7,7,7,7,7,8,0,0
DATA 15,7,7,7,7,7,7,8,8,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,15,7,7,7,7,7,7,7,8
DATA 0,0,15,7,7,7,7,7,7,7,7,8
DATA 0,15,7,7,7,7,7,7,7,7,7,8
DATA 0,15,7,7,7,7,7,7,7,7,7,8
DATA 0,0,15,7,7,7,7,7,7,7,7,8
DATA 0,0,0,15,7,7,7,7,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,7,1,7,7,8,8,0,0,0
DATA 15,7,7,1,1,7,7,7,7,8,0,0
DATA 15,7,7,7,1,7,7,7,7,7,8,0
DATA 15,7,7,7,1,7,7,7,7,7,8,0
DATA 15,7,7,7,1,7,7,7,7,8,0,0
DATA 15,7,7,1,1,1,7,8,8,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,15,7,7,1,7,7,7,7,8
DATA 0,0,15,7,7,1,1,7,7,7,7,8
DATA 0,15,7,7,7,7,1,7,7,7,7,8
DATA 0,15,7,7,7,7,1,7,7,7,7,8
DATA 0,0,15,7,7,7,1,7,7,7,7,8
DATA 0,0,0,15,7,1,1,1,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,2,2,7,7,8,8,0,0,0
DATA 15,7,2,7,7,2,7,7,7,8,0,0
DATA 15,7,7,7,2,7,7,7,7,7,8,0
DATA 15,7,7,2,7,7,7,7,7,7,8,0
DATA 15,7,2,7,7,7,7,7,7,8,0,0
DATA 15,7,2,2,2,2,7,8,8,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,15,7,7,2,2,7,7,7,8
DATA 0,0,15,7,7,2,7,7,2,7,7,8
DATA 0,15,7,7,7,7,7,2,7,7,7,8
DATA 0,15,7,7,7,7,2,7,7,7,7,8
DATA 0,0,15,7,7,2,7,7,7,7,7,8
DATA 0,0,0,15,7,2,2,2,2,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,4,4,7,7,8,8,0,0,0
DATA 15,7,4,7,7,4,7,7,7,8,0,0
DATA 15,7,7,7,7,4,7,7,7,7,8,0
DATA 15,7,7,4,4,7,7,7,7,7,8,0
DATA 15,7,7,7,7,4,7,7,7,8,0,0
DATA 15,7,4,7,7,4,7,8,8,0,0,0
DATA 15,7,7,4,4,7,8,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,15,15,7,7,7,7,7,8
DATA 0,0,0,15,7,7,4,4,7,7,7,8
DATA 0,0,15,7,7,4,7,7,4,7,7,8
DATA 0,15,7,7,7,7,7,7,4,7,7,8
DATA 0,15,7,7,7,7,4,4,7,7,7,8
DATA 0,0,15,7,7,7,7,7,4,7,7,8
DATA 0,0,0,15,7,4,7,7,4,7,7,8
DATA 0,0,0,0,15,15,4,4,7,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,8,15,0,0,0,0,0,0,0,0,0
DATA 8,7,7,15,0,0,0,0,0,0,0,0
DATA 8,7,7,7,15,15,0,0,0,0,0,0
DATA 8,7,9,9,7,7,15,0,0,0,0,0
DATA 8,7,9,7,9,7,7,15,15,0,0,0
DATA 8,7,9,7,7,9,7,7,7,15,0,0
DATA 8,7,9,7,7,7,9,7,7,7,15,0
DATA 8,7,9,7,7,7,9,7,7,7,15,0
DATA 8,7,9,7,7,9,7,7,7,15,0,0
DATA 8,7,9,7,9,7,7,15,15,0,0,0
DATA 8,7,9,9,7,7,15,0,0,0,0,0
DATA 8,7,7,7,15,15,0,0,0,0,0,0
DATA 8,7,7,15,0,0,0,0,0,0,0,0
DATA 0,8,15,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,8,15,0
DATA 0,0,0,0,0,0,0,8,8,7,7,15
DATA 0,0,0,0,0,0,8,7,7,7,7,15
DATA 0,0,0,0,8,8,7,7,9,9,7,15
DATA 0,0,0,8,7,7,7,9,7,9,7,15
DATA 0,0,8,7,7,7,9,7,7,9,7,15
DATA 0,8,7,7,7,9,7,7,7,9,7,15
DATA 0,8,7,7,7,9,7,7,7,9,7,15
DATA 0,0,8,7,7,7,9,7,7,9,7,15
DATA 0,0,0,8,7,7,7,9,7,9,7,15
DATA 0,0,0,0,8,8,7,7,9,9,7,15
DATA 0,0,0,0,0,0,8,7,7,7,7,15
DATA 0,0,0,0,0,0,0,8,8,7,7,15
DATA 0,0,0,0,0,0,0,0,0,8,15,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,8,15,0,0,0,0,0,0,0,0,0
DATA 8,7,7,15,0,0,0,0,0,0,0,0
DATA 8,7,9,7,15,15,0,0,0,0,0,0
DATA 8,7,9,9,7,7,15,0,0,0,0,0
DATA 8,7,9,7,9,7,7,15,15,0,0,0
DATA 8,7,9,15,15,9,7,7,7,15,0,0
DATA 8,7,8,3,3,15,9,7,7,7,15,0
DATA 8,7,8,3,3,15,9,7,7,7,15,0
DATA 8,7,9,15,15,9,7,7,7,15,0,0
DATA 8,7,9,7,9,7,7,15,15,0,0,0
DATA 8,7,9,9,7,7,15,0,0,0,0,0
DATA 8,7,9,7,15,15,0,0,0,0,0,0
DATA 8,7,7,15,0,0,0,0,0,0,0,0
DATA 0,8,15,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,8,15,0
DATA 0,0,0,0,0,0,0,8,8,7,7,15
DATA 0,0,0,0,0,0,8,7,7,7,7,15
DATA 0,0,0,0,8,8,7,7,9,9,7,15
DATA 0,0,0,8,7,7,7,9,7,9,7,15
DATA 0,0,8,7,7,9,15,15,7,9,7,15
DATA 0,8,7,7,9,8,3,3,15,9,7,15
DATA 0,8,7,7,9,8,3,3,15,9,7,15
DATA 0,0,8,7,7,9,15,15,7,9,7,15
DATA 0,0,0,8,7,7,7,9,7,9,7,15
DATA 0,0,0,0,8,8,7,7,9,9,7,15
DATA 0,0,0,0,0,0,8,7,7,9,7,15
DATA 0,0,0,0,0,0,0,8,8,7,7,15
DATA 0,0,0,0,0,0,0,0,0,8,15,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0
'
DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,7,7,7,8,0,0,0,0,0
DATA 15,7,7,14,7,7,7,8,8,0,0,0
DATA 15,7,7,14,7,7,7,7,7,8,0,0
DATA 15,7,7,14,14,14,14,14,7,7,8,0
DATA 15,7,7,14,14,7,7,7,7,7,8,0
DATA 15,14,14,14,14,7,7,7,7,8,0,0
DATA 15,7,7,7,14,7,7,8,8,0,0,0
DATA 15,7,7,7,14,7,8,0,0,0,0,0
DATA 15,7,7,7,8,8,0,0,0,0,0,0
DATA 15,7,7,8,0,0,0,0,0,0,0,0
DATA 0,15,8,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0

DATA 0,0,0,0,0,0,0,0,0,0,0,0
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,15,15,14,7,7,7,7,8
DATA 0,0,0,15,7,7,14,7,7,7,7,8
DATA 0,0,15,7,7,7,14,7,7,7,7,8
DATA 0,15,7,7,7,7,14,14,14,14,14,8
DATA 0,15,7,14,14,14,14,14,7,7,7,8
DATA 0,0,15,7,7,7,7,14,7,7,7,8
DATA 0,0,0,15,7,7,7,14,7,7,7,8
DATA 0,0,0,0,15,15,7,14,7,7,7,8
DATA 0,0,0,0,0,0,15,7,7,7,7,8
DATA 0,0,0,0,0,0,0,15,15,7,7,8
DATA 0,0,0,0,0,0,0,0,0,15,8,0
DATA 0,0,0,0,0,0,0,0,0,0,0,0




8
SCREEN 7
INPUT "X-"; MX
INPUT "Y-"; MY
IF MX > 26 THEN SCREEN 8
IF MX > 53 OR MY > 21 THEN SCREEN 9
IF MY > 38 THEN SCREEN 12
IF MX > 53 THEN MX = 53
IF MY > 52 THEN MY = 52
PRINT "X-"; MX; "Y-"; MY
REDIM L(MX + 1, MY + 1)
INPUT "Mines"; MN
INPUT "Bolts"; PN
5
FOR A = 1 TO MN
RD:
X = INT(MX * RND + 1)
Y = INT(MY * RND + 1)
IF L(X, Y) = 0 THEN L(X, Y) = 1 ELSE GOTO RD
NEXT A
FOR A = 1 TO PN
LD:
X = INT(MX * RND + 1)
Y = INT(MY * RND + 1)
IF L(X, Y) = 0 THEN L(X, Y) = 2 ELSE GOTO LD
NEXT A
GOSUB 2
X = INT(MX / 2 + .5)
Y = INT(MY / 2 + .5)
BN = MX * MY - MN
BB = 0
1 A$ = INKEY$
OX = X: OY = Y
IF JOY = 1 THEN
JX = STICK(0)
JY = STICK(1)
B1 = STRIG(0)
B2 = STRIG(4)
IF JX < 70 THEN X = X - 1
IF JX > 130 THEN X = X + 1
IF JY < 70 THEN Y = Y - 1
IF JY > 130 THEN Y = Y + 1
IF B1 = -1 THEN A$ = " "
IF B2 = -1 THEN A$ = "F"
END IF

IF BN = 0 THEN FOR A = 1 TO 100: COLOR 15 * RND, 15 * RND: NEXT A: REDIM L(MX + 1, MY + 1): DEAD = 0: COLOR , 0: GOTO 5
IF A$ = "`" THEN RUN "MINESWEP"
IF A$ = "R" THEN GOTO 8
IF A$ = "Q" THEN DEAD = 1
IF A$ = "8" THEN Y = Y - 1:                     
IF A$ = "4" THEN X = X - 1:
IF A$ = "2" THEN Y = Y + 1:
IF A$ = "6" THEN X = X + 1:
IF Y < 1 THEN Y = 1
IF X < 1 THEN X = 1
IF Y > MY THEN Y = MY
IF X > MX THEN X = MX
IF DEAD = 1 THEN FOR A = 1 TO 10: CIRCLE (X * 12 - 6, Y * 10 - 5), A, 12: CIRCLE (X * 12 - 5, Y * 10 - 5), A, 4: NEXT A: REDIM L(MX + 1, MY + 1): DEAD = 0: GOTO 5
IF A$ = " " THEN
L = L(X, Y)
IF L = 1 THEN DEAD = 1
IF L = 7 THEN DEAD = 1
IF L(X, Y) = 6 THEN L(X, Y) = 9: BN = BN - 1
IF L = 0 OR L = 9 OR L = 2 OR L = 8 THEN
IF L = 8 OR L = 2 THEN L(X, Y) = 10: GOSUB LZ1
IF L = 0 THEN L(X, Y) = 9: BN = BN - 1
XX = X: YY = Y
GOSUB 3
IF B = 0 THEN LN = 0: X(0) = X: Y(0) = Y: GOSUB 6
X = XX
Y = YY
END IF
END IF
'**************
IF A$ = "F" THEN
L = L(X, Y)
IF L = 0 THEN L = 3: GOTO 7
IF L = 1 THEN L = 4: GOTO 7
IF L = 2 THEN L = 5: GOTO 7
IF L = 3 THEN L = 6: GOTO 7
IF L = 4 THEN L = 7: GOTO 7
IF L = 5 THEN L = 8: GOTO 7
IF L = 6 THEN L = 0: GOTO 7
IF L = 7 THEN L = 1: GOTO 7
IF L = 8 THEN L = 2: GOTO 7
7
L(X, Y) = L
END IF
XX = X: YY = Y: X = OX: Y = OY: GOSUB 3
X = XX: Y = YY
GOTO 1
6 IF X <= 0 OR Y <= 0 OR X > MX OR Y > MY THEN RETURN
IF X / 2 = INT(X / 2) THEN TY = 1 ELSE TY = -1
IF Y / 2 <> INT(Y / 2) THEN TY = -TY
IF TY = 1 THEN X = X(LN) + 1: Y = Y(LN): GOSUB 9
X = X(LN): Y = Y(LN) - 1: GOSUB 9
IF TY = -1 THEN X = X(LN) - 1: Y = Y(LN): GOSUB 9
X = X(LN): Y = Y(LN) + 1: GOSUB 9
LN = LN - 1
RETURN
9 IF X <= 0 OR Y <= 0 OR X > MX OR Y > MY THEN RETURN
IF L(X, Y) = 8 OR L(X, Y) = 2 THEN
L(X, Y) = 10: GOSUB 3: GOSUB LZ1
IF B = 0 THEN LN = LN + 1: X(LN) = X: Y(LN) = Y: GOSUB 6
END IF
IF L(X, Y) = 0 THEN
L(X, Y) = 9
BN = BN - 1
GOSUB 3
IF B = 0 THEN LN = LN + 1: X(LN) = X: Y(LN) = Y: GOSUB 6
END IF
RETURN
2
CLS : FOR Y = 1 TO MY: FOR X = 1 TO MX: GOSUB 3: NEXT X: NEXT Y: RETURN
3
PY = Y * 9 - 9
PX = X * 12 - 12
IF X / 2 = INT(X / 2) THEN TY = 1 ELSE TY = -1
IF Y / 2 <> INT(Y / 2) THEN TY = -TY
IF TY = -1 THEN
LINE (PX, PY + 2)-(PX + 4, PY + 13), 0, BF
LINE (PX + 1, PY + 1)-(PX + 3, PY + 14), 0, BF
LINE (PX + 4, PY + 3)-(PX + 5, PY + 12), 0, B
LINE (PX + 6, PY + 4)-(PX + 6, PY + 11), 0
LINE (PX + 7, PY + 5)-(PX + 8, PY + 10), 0, B
LINE (PX + 9, PY + 6)-(PX + 9, PY + 9), 0
LINE (PX + 10, PY + 7)-(PX + 10, PY + 8), 0
END IF
IF TY = 1 THEN
LINE (PX + 7, PY + 2)-(PX + 11, PY + 13), 0, BF
LINE (PX + 9, PY + 1)-(PX + 10, PY + 14), 0, BF
LINE (PX + 6, PY + 3)-(PX + 6, PY + 12), 0
LINE (PX + 4, PY + 4)-(PX + 5, PY + 11), 0, B
LINE (PX + 3, PY + 5)-(PX + 3, PY + 10), 0
LINE (PX + 2, PY + 6)-(PX + 2, PY + 9), 0
LINE (PX + 1, PY + 7)-(PX + 1, PY + 8), 0
END IF
IF L(X, Y) = 9 THEN GOTO 12
IF TY = 1 THEN GOTO T2
IF L(X, Y) = 0 THEN PUT (PX, PY), A51%, XOR
IF L(X, Y) = 1 THEN PUT (PX, PY), A51%, XOR
IF L(X, Y) = 2 THEN PUT (PX, PY), A51%, XOR
IF L(X, Y) = 3 THEN PUT (PX, PY), A61%, XOR
IF L(X, Y) = 4 THEN PUT (PX, PY), A61%, XOR
IF L(X, Y) = 5 THEN PUT (PX, PY), A61%, XOR
IF L(X, Y) = 10 THEN PUT (PX, PY), A71%, XOR
RETURN
T2:
IF L(X, Y) = 0 THEN PUT (PX, PY), A52%, XOR
IF L(X, Y) = 1 THEN PUT (PX, PY), A52%, XOR
IF L(X, Y) = 2 THEN PUT (PX, PY), A52%, XOR
IF L(X, Y) = 3 THEN PUT (PX, PY), A62%, XOR
IF L(X, Y) = 4 THEN PUT (PX, PY), A62%, XOR
IF L(X, Y) = 5 THEN PUT (PX, PY), A62%, XOR
IF L(X, Y) = 10 THEN PUT (PX, PY), A72%, XOR
RETURN
12
B = 0
AY = Y
LL = 0
IF TY = 1 THEN AX = X + 1: LL = 0: IF AX > 0 AND AY > 0 AND AY < MY + 1 AND AX < MX + 1 THEN LL = L(AX, AY)
IF LL = 1 OR LL = 7 OR LL = 4 THEN B = B + 1
LL = 0
IF TY = -1 THEN AX = X - 1: LL = 0: IF AX > 0 AND AY > 0 AND AY < MY + 1 AND AX < MX + 1 THEN LL = L(AX, AY)
IF LL = 1 OR LL = 7 OR LL = 4 THEN B = B + 1
AX = X
LL = 0
AY = Y - 1: LL = 0: IF AX > 0 AND AY > 0 AND AY < MY + 1 AND AX < MX + 1 THEN LL = L(AX, AY)
IF LL = 1 OR LL = 7 OR LL = 4 THEN B = B + 1
LL = 0
AY = Y + 1: LL = 0: IF AX > 0 AND AY > 0 AND AY < MY + 1 AND AX < MX + 1 THEN LL = L(AX, AY)
IF LL = 1 OR LL = 7 OR LL = 4 THEN B = B + 1
IF Y > 0 AND X > 0 AND Y < MY + 1 AND X < MX + 1 THEN ON B + 1 GOSUB P0, P1, P2, P3
RETURN
P0: IF TY = -1 THEN PUT (PX, PY), A11% ELSE PUT (PX, PY), A12%
RETURN
P1: IF TY = -1 THEN PUT (PX, PY), A21% ELSE PUT (PX, PY), A22%
RETURN
P2: IF TY = -1 THEN PUT (PX, PY), A31% ELSE PUT (PX, PY), A32%
RETURN
P3: IF TY = -1 THEN PUT (PX, PY), A41% ELSE PUT (PX, PY), A42%
RETURN
LZ1: TXX = X: TYY = Y: SX = X: SY = Y
FOR X = SX - 1 TO SX + 1: FOR Y = SY - 1 TO SY + 1
IF L(X, Y) = 1 OR L(X, Y) = 7 THEN L(X, Y) = 4: GOSUB 3
NEXT Y: NEXT X: X = TXX: Y = TYY
FOR ZA = 1 TO 9.4 STEP .3: SOUND 400 + SIN(ZA) * 200, .07: NEXT ZA
L(X, Y) = 9: GOSUB 3: BN = BN - 1
RETURN


